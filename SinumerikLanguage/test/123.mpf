N1 R1=80 ;RADIUS FREZI
N2 R2=388.626 ;RASSTOINIE OT OSI VRACH DO POV 7
N3 R3=380 ;DLINA OBRABOTKI
N4 R4=320 ;VISOTA OBRABOTKI
N5 R5=2528.87+4.257 ;RASSTOIANIE M/D TORCAMI
N6 R6=SQRT(R2*R2+R5*R5/4)
N7 R7=ATAN2(R5/2,R2)
N8 R7=110-R7
N9 R8=3100 ;RASSTOIANIE OT CENTRA DO OSI VRACHENIA

N10 T1 D1 M6
N11 G90 G17 G54
N12 G0 B-110 
N13 X=R6*SIN(R7)-100-R1 Y250
N14 Z=R6*COS(R7)+50+R8

N15 S200 M3 M8

N16 G1 Z=R6*COS(R7)+R8 F3000
N17 X=R6*SIN(R7)+R3 F200
N18 Z=R6*COS(R7)+20+R8 F3000
N19 X=R6*SIN(R7)-100-R1 Y100
N20 G1 Z=R6*COS(R7)+R8
N21 X=R6*SIN(R7)+R3 F200
N22 Z=R6*COS(R7)+50+R8 F3000
N23 Y600
N24 M0

N25 G0 B110 
N26 X=-R6*SIN(R7)+100+R1 Y250
N27 Z=R6*COS(R7)+50+R8

N28 S200 M3 M8

N29 G1 Z=R6*COS(R7)+R8 F3000
N30 X=-R6*SIN(R7)-R3 F200
N31 Z=R6*COS(R7)+20+R8 F3000
N32 X=-R6*SIN(R7)+100+R1 Y100
N33 G1 Z=R6*COS(R7)+R8
N34 X=-R6*SIN(R7)-R3 F200
N35 Z=R6*COS(R7)+50+R8 F3000
N36 Y600
N37 M0

N38 G0 B0

N39 M0


N40 R1=4078.63 ;NARUGNII RADIUS
N41 R2=3100 ;RASSTOIANIE OT CENTRA DO OSI VRACHENIA
N42 R3=360/225 ;UGOLSHAG RAZVOROTA
N43 R4=24 ;CHISLO ZUBIEV
N44 R5=320 ;VISOTA OBRABOTKI


N45 G90 G17 G54

N46 T1 D1 M6
N47 G90 G17 G54

N48 G0 Y=R5+150
N49 R9=-12

N50 METKA6:
N51 R10=R3*R9
N52 B=-R10

N53 R7=2*R2*SIN(R10/2)*SIN(R10/2) ;Z
N54 R8=R2*SIN(R10) ;X 

N55 G1 X=-R8 Z=R1+R7 F2000

N56 S200 M3 M8

N57 Y-20 F250
N58 Z=R1+R7+50 F300
N59 Y=R5+150
N60 R9=R9+1
N61 IF R9<R4/2 GOTOB METKA6

N62 M5 M9
N63 M0


N64 R1=4078.63 ;RADIUS VERHIN
N65 R2=4010.4 ;RADIUS VPADIN
N66 R3=3805.7551 ;RADIUS OBRAZ
N67 R10=14.4 ;RADIUS PEREHODA


N68 R4=SQRT(R1*R1-R3*R3)*360/(2*3.1416*R3)
N69 R5=19.0591 ;ACOS(R3/(R2+R10)) UGOL NACHALA RADIUSA 
N70 R6=0.2 ;UGLOVOI SHG NA EVOLVENTE
N71 R6=(R4-R5)/(1+TRUNC((R4-R5)/R6))
N72 R14=4 ;UGL SHAG PRI OBRABOTKE
N73 R14=(90-R5)/(1+TRUNC((90-R5)/R14)) 


N74 R7=320 ;VISOTA OBRABOTKI
N75 R8=12.5 ;RADIUS FREZI

N76 R16=360/225 ;UGOL RAZVOROTA
N77 R15=3100 ;RASSTOIANIE OT CENTRA DO OSI VRACHENIA
N78 R28=9.7021 ;R-R PEREMICHKI
N79 R29=1 ;SHAG NA PEREMICHKU
N80 R29=R28/(1+TRUNC(R28/R29))
N81 R36=0.4412 ;UGOL NACHALA EVOLVENTI
N82 R37=25 ;CHISLO ZUBIEV
N83 R5=R5+R36


N84 T5 D5 M6
N85 G90 G17 G54

N86 G0 Y=R7+300
N87 R19=-(R37/2-1)


N88 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
N89 ;1 polyvpadina;
N90 ;;;;;;;;;;;;;;;

N91 ;;;stenka
N92 R20=R16*(R19-1)-R36

N93 R17=2*R15*SIN(R20/2)*SIN(R20/2) ;Z
N94 R18=R15*SIN(R20) ;X 

N95 G1 X=-R3*SIN(R4)+(2*R3*3.1416*R4/360+R8)*COS(R4)-R18 F2000
N96 Z=R3*COS(R4)+(2*3.1416*R3*R4/360+R8)*SIN(R4)-R8+R17

N97 R9=-R6
N98 METKA7:
N99 R9=R9+R6
N100 G1 R11=-R3*SIN(R4-R9)+(2*R3*3.1416*(R4-R9)/360)*COS(R4-R9)-R18 F2000 ;X
N101 R12=R3*COS(R4-R9)+(2*3.1416*R3*(R4-R9)/360)*SIN(R4-R9)+R17  ;Z
N102 R24=SQRT(R11*R11+R12*R12)
N103 R35=ATAN2(R11,R12)
N104 R26=SQRT(R15*R15+R24*R24-2*R15*R24*COS(R35))
N105 R27=ASIN(R11/R26)
N106 R25=-R4+R9
N107 R30=R25-R16*(R19-1)+R36
N108 B=R30


N109 R31=R26*SIN(R27-R25) ;X
N110 R32=R26*COS(R27-R25)+R15 ;Y


N111 X=R31+R8
N112 Z=R32-R8
N113 Y=-10-R8 F450
N114 Z=R32+100 F2000
N115 Y=R7+R8+10
N116 IF R9<((R4-R5)-0.5*R6) GOTOB METKA7

N117 Y=R7+300
N118 M0

N119 ;;;;;SKRUGLENIE

N120 B=-R20



N121 R17=2*R15*SIN(R20/2)*SIN(R20/2) ;Z
N122 R18=R15*SIN(R20) ;X 
N123 R9=R4-R5
N124 R11=-R3*SIN(R4-R9)+(2*R3*3.1416*(R4-R9)/360+R8)*COS(R4-R9)-R18 
N125 R12=R3*COS(R4-R9)+(2*3.1416*R3*(R4-R9)/360+R8)*SIN(R4-R9)-R8+R17
N126 R9=R5


N127 METKA8:
N128 R9=R9+R14
N129 X=R11+(R10-R8)*(COS(R5)-COS(R9))
N130 Z=R12-(R10-R8)*(SIN(R9)-SIN(R5))
N131 Y=-10-R8 F450
N132 Z=R1+10+R17 F2000
N133 Y=R7+R8+10
N134 IF R9<((90-R5)-0.5*R14) GOTOB METKA8


N135 Y=R7+300
N136 m0


N137 ;peremichka


N138 R33=R16*(R19-1)
N139 B=-R33

N140 R17=2*R15*SIN(R33/2)*SIN(R33/2) ;Z
N141 R18=R15*SIN(R33) ;X 

N142 R34=0
N143 Y=R7+R8+10


N144 METKA9:
N145 R34=R34+R29
N146 G1 X=-R28/2+R34-R18 F3000
N147 Z=R2+R17
N148 Y=-10-R8 F450
N149 Z=R2+R17+10 F2000
N150 Y=R7+R8+10
N151 IF R34<(R28-0.5*R29) GOTOB METKA9

N152 M0
N153 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

N154 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
N155 ;POSLEDN polyvpadina;
N156 ;;;;;;;;;;;;;;;;;;;;;


N157 ;STENKA

N158 R23=-R16*(R19+R37-1)-R36


N159 R17=2*R15*SIN(R23/2)*SIN(R23/2) ;Z
N160 R18=R15*SIN(R23) ;X 


N161 G1 X=R3*SIN(R4)-(2*R3*3.1416*R4/360+R8)*COS(R4)+R18 F2000
N162 Z=R3*COS(R4)+(2*3.1416*R3*R4/360+R8)*SIN(R4)-R8+R17

N163 R9=-R6
N164 METKA10:
N165 R9=R9+R6
N166 G1 R11=R3*SIN(R4-R9)-(2*R3*3.1416*(R4-R9)/360)*COS(R4-R9)+R18 F2000 ;X
N167 R12=R3*COS(R4-R9)+(2*3.1416*R3*(R4-R9)/360)*SIN(R4-R9)+R17  ;Z
N168 R24=SQRT(R11*R11+R12*R12)
N169 R35=ATAN2(R11,R12)
N170 R26=SQRT(R15*R15+R24*R24-2*R15*R24*COS(R35))
N171 R27=ASIN(R11/R26)
N172 R25=R4-R9
N173 R30=R25-R16*(R19+R37-1)-R36
N174 B=R30


N175 R31=R26*SIN(R27-R25) ;X
N176 R32=R26*COS(R27-R25)+R15 ;Y


N177 X=R31-R8
N178 Z=R32-R8
N179 Y=-10-R8 F450
N180 Z=R32+100 F2000
N181 Y=R7+R8+10
N182 IF R9<((R4-R5)-0.5*R6) GOTOB METKA10

N183 Y=R7+300
N184 M0

N185 ;RADIUS

N186 B=R23


N187 R9=R4-R5
N188 R17=2*R15*SIN(R23/2)*SIN(R23/2) ;Z
N189 R18=R15*SIN(R23) ;X 
N190 R11=R3*SIN(R4-R9)-(2*R3*3.1416*(R4-R9)/360+R8)*COS(R4-R9)+R18 
N191 R12=R3*COS(R4-R9)+(2*3.1416*R3*(R4-R9)/360+R8)*SIN(R4-R9)-R8+R17
N192 R9=R5


N193 METKA4:
N194 R9=R9+R14
N195 X=R11-(R10-R8)*(COS(R5)-COS(R9))
N196 Z=R12-(R10-R8)*(SIN(R9)-SIN(R5))
N197 Y=-10-R8 F450
N198 Z=R1+10+R17 F2000
N199 Y=R7+R8+10
N200 IF R9<((90-R5)-0.5*R14) GOTOB METKA4

N201 Y=R7+300
N202 M0


N203 ;peremichka


N204 R33=R16*(R19+R37-1)
N205 B=-R33

N206 R17=2*R15*SIN(R33/2)*SIN(R33/2) ;Z
N207 R18=R15*SIN(R33) ;X 

N208 R34=0
N209 Y=R7+R8+10


N210 METKA9:
N211 R34=R34+R29
N212 G1 X=-R28/2+R34-R18 F3000
N213 Z=R2+R17
N214 Y=-10-R8 F450
N215 Z=R2+R17+10 F2000
N216 Y=R7+R8+10
N217 IF R34<(R28-0.5*R29) GOTOB METKA9

N218 M0



N219 ;;;;;;;;;;;;;;;;;;;;;;;;;
N220 ;;;OSNOVN CHAST;;;;;;;;;;
N221 ;;;;;;;;;;;;;;;;;;;;;;;;;


N222 ;1 STENKA

N223 LABEL1:
N224 R20=R16*R19-R36

N225 R17=2*R15*SIN(R20/2)*SIN(R20/2) ;Z
N226 R18=R15*SIN(R20) ;X 

N227 G1 X=-R3*SIN(R4)+(2*R3*3.1416*R4/360+R8)*COS(R4)-R18 F2000
N228 Z=R3*COS(R4)+(2*3.1416*R3*R4/360+R8)*SIN(R4)-R8+R17

N229 R9=-R6
N230 METKA1:
N231 R9=R9+R6
N232 G1 R11=-R3*SIN(R4-R9)+(2*R3*3.1416*(R4-R9)/360)*COS(R4-R9)-R18 F2000 ;X
N233 R12=R3*COS(R4-R9)+(2*3.1416*R3*(R4-R9)/360)*SIN(R4-R9)+R17  ;Z
N234 R24=SQRT(R11*R11+R12*R12)
N235 R35=ATAN2(R11,R12)
N236 R26=SQRT(R15*R15+R24*R24-2*R15*R24*COS(R35))
N237 R27=ASIN(R11/R26)
N238 R25=-R4+R9
N239 R30=R25-R16*R19+R36
N240 B=R30


N241 R31=R26*SIN(R27-R25) ;X
N242 R32=R26*COS(R27-R25)+R15 ;Y


N243 X=R31+R8
N244 Z=R32-R8
N245 Y=-10-R8 F450
N246 Z=R32+100 F2000
N247 Y=R7+R8+10
N248 IF R9<((R4-R5)-0.5*R6) GOTOB METKA1

N249 Y=R7+300


N250 ;M0

N251 ;2 STENKA

N252 R23=-R16*R19-R36


N253 R17=2*R15*SIN(R23/2)*SIN(R23/2) ;Z
N254 R18=R15*SIN(R23) ;X 


N255 G1 X=R3*SIN(R4)-(2*R3*3.1416*R4/360+R8)*COS(R4)+R18 F2000
N256 Z=R3*COS(R4)+(2*3.1416*R3*R4/360+R8)*SIN(R4)-R8+R17

N257 R9=-R6
N258 METKA3:
N259 R9=R9+R6
N260 G1 R11=R3*SIN(R4-R9)-(2*R3*3.1416*(R4-R9)/360)*COS(R4-R9)+R18 F2000 ;X
N261 R12=R3*COS(R4-R9)+(2*3.1416*R3*(R4-R9)/360)*SIN(R4-R9)+R17  ;Z
N262 R24=SQRT(R11*R11+R12*R12)
N263 R35=ATAN2(R11,R12)
N264 R26=SQRT(R15*R15+R24*R24-2*R15*R24*COS(R35))
N265 R27=ASIN(R11/R26)
N266 R25=R4-R9
N267 R30=R25-R16*R19-R36
N268 B=R30


N269 R31=R26*SIN(R27-R25) ;X
N270 R32=R26*COS(R27-R25)+R15 ;Y


N271 X=R31-R8
N272 Z=R32-R8
N273 Y=-10-R8 F450
N274 Z=R32+100 F2000
N275 Y=R7+R8+10
N276 IF R9<((R4-R5)-0.5*R6) GOTOB METKA3

N277 Y=R7+300

N278 ;M0

N279 ;OBRABOTKA RADIUSA
N280 ;1

N281 B=-R20



N282 R17=2*R15*SIN(R20/2)*SIN(R20/2) ;Z
N283 R18=R15*SIN(R20) ;X 
N284 R9=R4-R5
N285 R11=-R3*SIN(R4-R9)+(2*R3*3.1416*(R4-R9)/360+R8)*COS(R4-R9)-R18 
N286 R12=R3*COS(R4-R9)+(2*3.1416*R3*(R4-R9)/360+R8)*SIN(R4-R9)-R8+R17
N287 R9=R5


N288 METKA2:
N289 R9=R9+R14
N290 X=R11+(R10-R8)*(COS(R5)-COS(R9))
N291 Z=R12-(R10-R8)*(SIN(R9)-SIN(R5))
N292 Y=-10-R8 F450
N293 Z=R1+10+R17 F2000
N294 Y=R7+R8+10
N295 IF R9<((90-R5)-0.5*R14) GOTOB METKA2


N296 Y=R7+300
N297 ;m0


N298 ;2

N299 B=R23


N300 R9=R4-R5
N301 R17=2*R15*SIN(R23/2)*SIN(R23/2) ;Z
N302 R18=R15*SIN(R23) ;X 
N303 R11=R3*SIN(R4-R9)-(2*R3*3.1416*(R4-R9)/360+R8)*COS(R4-R9)+R18 
N304 R12=R3*COS(R4-R9)+(2*3.1416*R3*(R4-R9)/360+R8)*SIN(R4-R9)-R8+R17
N305 R9=R5


N306 METKA4:
N307 R9=R9+R14
N308 X=R11-(R10-R8)*(COS(R5)-COS(R9))
N309 Z=R12-(R10-R8)*(SIN(R9)-SIN(R5))
N310 Y=-10-R8 F450
N311 Z=R1+10+R17 F2000
N312 Y=R7+R8+10
N313 IF R9<((90-R5)-0.5*R14) GOTOB METKA4

N314 Y=R7+300


N315 ;peremichka
N316 R33=R16*R19
N317 B=-R33

N318 R17=2*R15*SIN(R33/2)*SIN(R33/2) ;Z
N319 R18=R15*SIN(R33) ;X 

N320 R34=0
N321 Y=R7+R8+10


N322 METKA5:
N323 R34=R34+R29
N324 G1 X=-R28/2+R34-R18 F3000
N325 Z=R2+R17
N326 Y=-10-R8 F450
N327 Z=R2+R17+10 F2000
N328 Y=R7+R8+10
N329 IF R34<(R28-0.5*R29) GOTOB METKA5


N330 R19=R19+1
N331 ;M0
N332 IF R19<5 GOTOB LABEL1 
N333 
N334 m30